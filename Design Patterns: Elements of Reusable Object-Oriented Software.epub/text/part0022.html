<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Footnotes</title>
    <link href="page-template.xpgt" type="application/vnd.adobe-page-template+xml" rel="stylesheet"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="../page_styles.css" type="text/css" rel="stylesheet"/>
</head>
  <body class="calibre">
<p class="calibre1"><a id="foot"></a></p>
<div class="calibre5"></div><h2 class="calibre6" id="calibre_pb_0">Footnotes</h2>
<p class="calibre1"><a id="foot1"></a></p>
<h3 class="calibre2">Chapter 2</h3>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn01"></a><a href="part0011.html#ch02fn_01">1</a></sup>Lexi’s design is based on Doc, a text editing application developed by Calder <a href="part0020.html#bib01_019">[CL92]</a>.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn02"></a><a href="part0011.html#ch02fn_02">2</a></sup>Authors often view the document in terms of its <em class="calibre7">logical</em> structure as well, that is, in terms of sentences, paragraphs, sections, subsections, and chapters. To keep this example simple, our internal representation won’t store information about the logical structure explicitly. But the design solution we describe works equally well for representing such information.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn03"></a><a href="part0011.html#ch02fn_03">3</a></sup>Calder was the first to use the term “glyph” in this context <a href="part0020.html#bib01_018">[CL90]</a>. Most contemporary document editors don’t use an object for every character, presumably for efficiency reasons. Calder demonstrated that this approach is feasible in his thesis <a href="part0020.html#bib01_014">[Cal93]</a>. Our glyphs are less sophisticated than his in that we have restricted ours to strict hierarchies for simplicity. Calder’s glyphs can be shared to reduce storage costs, thereby forming directed-acyclic graph structures. We can apply the Flyweight (<a href="part0014.html#page_195">195</a>) pattern to get the same effect, but we’ll leave that as an exercise for the reader.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn04"></a><a href="part0011.html#ch02fn_04">4</a></sup>The interface we describe here is purposely minimal to keep the discussion simple. A complete interface would include operations for managing graphical attributes such as color, font, and coordinate transformations, plus operations for more sophisticated child management.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn05"></a><a href="part0011.html#ch02fn_05">5</a></sup>An integer index is probably not the best way to specify a glyph’s children, depending on the data structure the glyph uses. If it stores its children in a linked list, then a pointer into the list would be more efficient. We’ll see a better solution to the indexing problem in <a href="part0011.html#ch02sec1lev8">Section 2.8</a>, when we discuss document analysis.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn06"></a><a href="part0011.html#ch02fn_06">6</a></sup>The user will have even more to say about the document’s <em class="calibre7">logical</em> structure—the sentences, paragraphs, sections, chapters, and so forth. The <em class="calibre7">physical</em> structure is less interesting by comparison. Most people don’t care where the linebreaks in a paragraph occur as long as the paragraph is formatted properly. The same is true for formatting columns and pages. Thus users end up specifying only high-level constraints on the physical structure, leaving Lexi to do the hard work of satisfying them.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn07"></a><a href="part0011.html#ch02fn_07">7</a></sup>The compositor must get the character codes of Character glyphs in order to compute the linebreaks. In <a href="part0011.html#ch02sec1lev8">Section 2.8</a> we’ll see how to get this information polymorphically without adding a character-specific operation to the Glyph interface.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn08"></a><a href="part0011.html#ch02fn_08">8</a></sup>That is, redoing an operation that was just undone.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn09"></a><a href="part0011.html#ch02fn_09">9</a></sup>Conceptually, the client is Lexi’s user, but in reality it’s another object (such as an event dispatcher) that manages inputs from the user.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn10"></a><a href="part0011.html#ch02fn_10">10</a></sup>We could use function overloading to give each of these member functions the same name, since their parameters already differentiate them. We’ve given them different names here to emphasize their differences, especially when they’re called.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn11"></a><a href="part0011.html#ch02fn_11">11</a></sup><code class="calibre13">IsMisspelled</code> implements the spelling algorithm, which we won’t detail here because we’ve made it independent of Lexi’s design. We can support different algorithms by subclassing <code class="calibre13">SpellingChecker</code>; alternatively, we can apply the Strategy (<a href="part0015.html#page_315">315</a>) pattern (as we did for formatting in <a href="part0011.html#ch02sec1lev3">Section 2.3</a>) to support different spelling checking algorithms.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch02fn12"></a><a href="part0011.html#ch02fn_12">12</a></sup>“Visit” is just a slightly more general term for “analyze.” It foreshadows the terminology we use in the design pattern we’re leading to.</p>
<p class="calibre1"><a id="foot2"></a></p>
<h3 class="calibre2">Chapter 3</h3>
<p class="calibre1"><sup class="calibre8"><a id="ch03fn01"></a><a href="part0013.html#ch03fn_01">1</a></sup>Such applications reflect the Composite (<a href="part0014.html#page_163">163</a>) and Decorator (<a href="part0014.html#page_175">175</a>) patterns.</p>
<p class="calibre1"><a id="foot3"></a></p>
<h3 class="calibre2">Chapter 4</h3>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn01"></a><a href="part0014.html#ch04fn_01">1</a></sup><code class="calibre13">CreateManipulator</code> is an example of a Factory Method (<a href="part0013.html#page_107">107</a>).</p>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn02"></a><a href="part0014.html#ch04fn_02">2</a></sup>It’s easy to forget to delete the iterator once you’re done with it. The Iterator pattern shows how to guard against such bugs on page <a href="part0015.html#page_266">266</a>.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn03"></a><a href="part0014.html#ch04fn_03">3</a></sup>Look-up time in this scheme is proportional to the font change frequency. Worst-case performance occurs when a font change occurs on every character, but that’s unusual in practice.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn04"></a><a href="part0014.html#ch04fn_04">4</a></sup>In the Sample Code given earlier, style information is made extrinsic, leaving the character code as the only intrinsic state.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn05"></a><a href="part0014.html#ch04fn_05">5</a></sup>See <a href="part0013.html#ch03sec1lev1">Abstract Factory</a> (<a href="part0013.html#ch03sec1lev1">87</a>) for another approach to look-and-feel independence.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn06"></a><a href="part0014.html#ch04fn_06">6</a></sup>The implementation of distributed objects in NEXTSTEP <a href="part0020.html#bib01_001">[Add94]</a> (specifically, the class NXProxy) uses this technique. The implementation redefines <code class="calibre13">forward</code>, the equivalent hook in NEXTSTEP.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn07"></a><a href="part0014.html#ch04fn_07">7</a></sup>Iterator (<a href="part0015.html#page_257">257</a>) describes another kind of proxy on page <a href="part0015.html#page_266">266</a>.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch04fn08"></a><a href="part0014.html#ch04fn_08">8</a></sup>Almost all classes ultimately have Object as their superclass. Hence this is the same as saying “defining a class that doesn’t have Object as its superclass.”</p>
<p class="calibre1"><a id="foot4"></a></p>
<h3 class="calibre2">Chapter 5</h3>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn01"></a><a href="part0015.html#ch05fn_01">1</a></sup>For simplicity, we ignore operator precedence and assume it’s the responsibility of whichever object constructs the syntax tree.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn02"></a><a href="part0015.html#ch05fn_02">2</a></sup>Booch refers to external and internal iterators as active and passive iterators, respectively <a href="part0020.html#bib01_010">[Boo94]</a>. The terms “active” and “passive” describe the role of the client, not the level of activity in the iterator.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn03"></a><a href="part0015.html#ch05fn_03">3</a></sup>Cursors are a simple example of the Memento (<a href="part0015.html#page_283">283</a>) pattern and share many of its implementation issues.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn04"></a><a href="part0015.html#ch05fn_04">4</a></sup>We can make this interface even <em class="calibre7">smaller</em> by merging Next, IsDone, and CurrentItem into a single operation that advances to the next object and returns it. If the traversal is finished, then this operation returns a special value (0, for instance) that marks the end of the iteration.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn05"></a><a href="part0015.html#ch05fn_05">5</a></sup>You can ensure this at compile-time just by declaring private <code class="calibre13">new</code> and <code class="calibre13">delete</code> operators. An accompanying implementation isn’t needed.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn06"></a><a href="part0015.html#ch05fn_06">6</a></sup>The <code class="calibre13">Traverse</code> operation in these examples is a Template Method (<a href="part0015.html#page_325">325</a>) with primitive operations <code class="calibre13">TestItem</code> and <code class="calibre13">ProcessItem</code>.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn07"></a><a href="part0015.html#ch05fn_07">7</a></sup>Note that our example deletes the state object at the end of the iteration. But <code class="calibre13">delete</code> won’t get called if <code class="calibre13">ProcessItem</code> throws an exception, thus creating garbage. This is a problem in C++ but not in Dylan, which has garbage collection. We discuss a solution to this problem on page <a href="part0015.html#page_266">266</a>.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn08"></a><a href="part0015.html#ch05fn_08">8</a></sup>This example is based on the TCP connection protocol described by Lynch and Rose <a href="part0020.html#bib01_057">[LR93]</a>.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn09"></a><a href="part0015.html#ch05fn_09">9</a></sup>This makes each <code class="calibre13">TCPState</code> subclass a Singleton (see <a href="part0013.html#ch03sec1lev5">Singleton</a> (<a href="part0013.html#ch03sec1lev5">127</a>)).</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn10"></a><a href="part0015.html#ch05fn_10">10</a></sup>We could use function overloading to give these operations the same simple name, like <code class="calibre13">Visit</code>, since the operations are already differentiated by the parameter they’re passed. There are pros and cons to such overloading. On the one hand, it reinforces the fact that each operation involves the same analysis, albeit on a different argument. On the other hand, that might make what’s going on at the call site less obvious to someone reading the code. It really boils down to whether you believe function overloading is good or not.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn11"></a><a href="part0015.html#ch05fn_11">11</a></sup>If we can have <em class="calibre7">double-dispatch,</em> then why not <em class="calibre7">triple</em> or <em class="calibre7">quadruple,</em> or any other number? Actually, double-dispatch is just a special case of multiple dispatch, in which the operation is chosen based on any number of types. (CLOS actually supports multiple dispatch.) Languages that support double- or multiple dispatch lessen the need for the Visitor pattern.</p>
<p class="calibre1"><sup class="calibre8"><a id="ch05fn12"></a><a href="part0015.html#ch05fn_12">12</a></sup>This theme runs through other kinds of patterns, too. Abstract Factory (<a href="part0013.html#page_87">87</a>), Builder (<a href="part0013.html#page_97">97</a>), and Prototype (<a href="part0013.html#page_117">117</a>) all encapsulate knowledge about how objects are created. Decorator (<a href="part0014.html#page_175">175</a>) encapsulates responsibility that can be added to an object. Bridge (<a href="part0014.html#page_151">151</a>) separates an abstraction from its implementation, letting them vary independently.</p>
<p class="calibre1"><a id="foot5"></a></p>
<h3 class="calibre2">Chapter 6</h3>
<p class="calibre1"><sup class="calibre8"><a id="ch06fn01"></a><a href="part0016.html#ch06fn_01">1</a></sup>See “The poetry of the language” [AIS<sup class="calibre8">+</sup>77].</p>
<p class="calibre1"><a id="foot6"></a></p>
<h3 class="calibre2">Appendix B</h3>
<p class="calibre1"><sup class="calibre8"><a id="app02fn01"></a><a href="part0018.html#app02fn_01">1</a></sup>OMT uses the term “object diagram” to refer to class diagrams. We use “object diagram” exclusively to refer to diagrams of object structures.</p>
<p class="calibre1"><sup class="calibre8"><a id="app02fn02"></a><a href="part0018.html#app02fn_02">2</a></sup>OMT also defines <strong class="calibre4">associations</strong> between classes, which appear as plain lines between class boxes. Associations are bidirectional. Although associations are appropriate during analysis, we feel they’re too high-level for expressing the relationships in design patterns, simply because associations must be mapped down to object references or pointers during design. Object references are intrinsically directed and are therefore better suited to the relationships that concern us. For example, Drawing knows about Shapes, but the Shapes don’t know about the Drawing they’re in. You can’t express this relationship with associations alone.</p>
</body></html>
